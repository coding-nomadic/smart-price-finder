<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Smart Price Finder</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #121212;
            color: #f5f5f5;
            margin: 0;
            padding: 0;
        }

        header {
            background: #1f1f1f;
            padding: 25px;
            text-align: center;
            color: #00bcd4;
            font-size: 2.5rem;
            font-weight: bold;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Form styles */
        .form-center {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 50vh;
            flex-direction: column;
        }

        .form-top {
            margin-bottom: 30px;
        }

        form {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            width: 100%;
        }

        input[type="text"] {
            width: 70%;
            min-width: 300px;
            padding: 15px;
            border-radius: 10px;
            font-size: 1.2rem;
            border: none;
        }

        input[type="text"]::placeholder {
            font-size: 1.2rem;
        }

        .row {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            width: 70%;
            min-width: 300px;
        }

        select, button {
            flex: 1 1 120px;
            min-width: 100px;
            padding: 12px;
            border-radius: 8px;
            border: none;
            font-size: 1.2rem;
        }

        select {
            background: #1f1f1f;
            color: #f5f5f5;
        }

        button {
            background: #00bcd4;
            color: #fff;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s;
        }

        button:hover {
            background: #0097a7;
        }

        /* Store Cards */
        .store-card {
            background: #1e1e1e;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.5);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 25px;
        }

        .left-info {
            flex: 2;
            font-size: 1.1rem;
        }

        .right-info {
            flex: 1;
            text-align: right;
            font-size: 1.3rem;
            font-weight: 600;
        }

        .right-info .price { color: #2e7d32; font-size: 1.5rem; font-weight: bold; }
        .right-info .discount { color: #ff6f00; }
        .right-info .rating { color: #fbc02d; }

        .availability.in-stock { color: #4caf50; font-weight: bold; }
        .availability.low-stock { color: #ff9800; font-weight: bold; }
        .availability.out-of-stock { color: #f44336; font-weight: bold; }

        .error {
            background: #f44336;
            color: white;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.2rem;
        }

        /* Toast */
        #toast {
            display:none;
            margin:10px auto;
            padding:18px 25px;
            background:#ff9800;
            color:#fff;
            border-radius:10px;
            text-align:center;
            max-width:450px;
            font-weight:bold;
            font-size: 1.2rem;
            box-shadow:0 2px 6px rgba(0,0,0,0.5);
            opacity:0;
            transition: opacity 0.5s;
        }

        /* Right sliding sidebar */
        .side-nav {
            position: fixed;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            background: #1f1f1f;
            border-radius: 8px 0 0 8px;
            overflow: hidden;
            transition: width 0.3s;
            width: 50px;
            z-index: 1000;
        }

        .side-nav:hover { width: 150px; }
        .side-nav ul { list-style: none; padding: 0; margin: 0; }
        .side-nav ul li { display: block; text-align: center; margin: 10px 0; }
        .side-nav ul li a {
            display: block; color: #00bcd4; padding: 10px; text-decoration: none;
            font-weight: bold; white-space: nowrap; transition: 0.2s;
        }
        .side-nav ul li a:hover { background-color: #333; border-radius: 4px; }

        /* Mobile responsiveness */
        @media (max-width:768px){
            input[type="text"], .row { width: 90%; }
            input[type="text"], select, button { font-size: 1.3rem; padding: 14px; }
            .card-header { flex-direction: column; gap: 15px; }
            .right-info { text-align: left; }
        }
    </style>
</head>
<body>
<header>
    Smart Price Finder
</header>

<div class="side-nav">
    <ul>
        <li><a th:href="@{/}">Home</a></li>
        <li><a th:href="@{/about}">About</a></li>
        <li><a th:href="@{/contact}">Contact Us</a></li>
    </ul>
</div>

<div class="container">
    <!-- Search Form -->
    <div class="container" th:class="${#lists.isEmpty(stores)} ? 'form-center' : 'form-top'">
        <form action="/generate" method="post">

            <!-- Product search input -->
            <input type="text" name="query" placeholder="Search for a product..." required>

            <!-- Province, City, Button -->
            <div class="row">
                <select id="province" name="province" required>
                    <option value="" disabled selected>Province</option>
                    <option value="AB">Alberta</option>
                    <option value="BC">British Columbia</option>
                    <option value="MB">Manitoba</option>
                    <option value="NB">New Brunswick</option>
                    <option value="NL">Newfoundland and Labrador</option>
                    <option value="NS">Nova Scotia</option>
                    <option value="ON">Ontario</option>
                    <option value="PE">Prince Edward Island</option>
                    <option value="QC">Quebec</option>
                    <option value="SK">Saskatchewan</option>
                    <option value="NT">Northwest Territories</option>
                    <option value="NU">Nunavut</option>
                    <option value="YT">Yukon</option>
                </select>

                <select id="city" name="city" required>
                    <option value="" disabled selected>City</option>
                </select>

                <button type="submit">Find Prices</button>
            </div>
        </form>
    </div>

    <!-- Error Message -->
    <div th:if="${error}" class="error" th:text="${error}"></div>

    <!-- Toast -->
    <div id="toast">No Product Found in this location, try some other locations!</div>

    <!-- Store Results -->
    <div th:each="store : ${stores}" class="store-card" th:data-availability="${store.availability}">
        <div class="card-header">
            <div class="left-info">
                <h3 th:text="${store.productName}">Product Name</h3>
                <p><strong>Store:</strong> <span th:text="${store.storeName}">Store Name</span>
                    (<span th:text="${store.storeType}">Type</span>)</p>
                <p><strong>Availability:</strong>
                    <span class="availability"
                          th:classappend="${store.availability == 'In Stock'} ? ' in-stock' :
                                          (${store.availability == 'Low Stock'} ? ' low-stock' : ' out-of-stock')"
                          th:text="${store.availability}">
                    </span>
                </p>
                <p><strong>Distance:</strong> <span th:text="${store.distance}">0</span></p>
                <p><strong>Address:</strong> <span th:text="${store.location}">Address</span></p>
                <p><strong>Last Updated:</strong> <span th:text="${store.lastUpdated}">Today</span></p>
                <p><strong>Website:</strong> <a th:href="${store.website}" target="_blank">Visit Store</a></p>
            </div>
            <div class="right-info">
                <p class="price">üí≤ $<span th:text="${store.price}">0.00</span></p>
                <p class="discount">üéØ <span th:text="${store.discount}">0%</span></p>
                <p class="rating">‚≠ê <span th:text="${store.rating}">0</span>/5</p>
            </div>
        </div>
    </div>
</div>
<script>
    const provinceCities = {
        "AB": ["Calgary", "Edmonton", "Red Deer", "Lethbridge", "Fort McMurray", "Medicine Hat", "Grande Prairie"],
        "BC": ["Vancouver", "Victoria", "Kelowna", "Surrey", "Burnaby", "Richmond", "Abbotsford", "Nanaimo"],
        "MB": ["Winnipeg", "Brandon", "Steinbach", "Thompson", "Portage la Prairie", "Selkirk"],
        "NB": ["Moncton", "Fredericton", "Saint John", "Dieppe", "Miramichi", "Bathurst"],
        "NL": ["St. John's", "Mount Pearl", "Corner Brook", "Gander", "Grand Falls-Windsor", "Clarenville"],
        "NS": ["Halifax", "Sydney", "Dartmouth", "Truro", "New Glasgow", "Glace Bay"],
        "ON": ["Toronto", "Ottawa", "Hamilton", "London", "Mississauga", "Brampton", "Kitchener", "Windsor", "Thunder Bay"],
        "PE": ["Charlottetown", "Summerside", "Stratford", "Cornwall", "Montague"],
        "QC": ["Montreal", "Quebec City", "Laval", "Gatineau", "Longueuil", "Sherbrooke", "Trois-Rivi√®res", "L√©vis"],
        "SK": ["Saskatoon", "Regina", "Prince Albert", "Moose Jaw", "Yorkton", "Swift Current"],
        "NT": ["Yellowknife", "Hay River", "Fort Smith", "Inuvik"],
        "NU": ["Iqaluit", "Rankin Inlet", "Arviat", "Cambridge Bay"],
        "YT": ["Whitehorse", "Dawson City", "Watson Lake"]
    };

    const provinceSelect = document.getElementById('province');
    const citySelect = document.getElementById('city');

    provinceSelect.addEventListener('change', function() {
        const cities = provinceCities[this.value] || [];
        citySelect.innerHTML = '<option value="" disabled selected>City</option>';
        cities.forEach(city => {
            const option = document.createElement('option');
            option.value = city;
            option.textContent = city;
            citySelect.appendChild(option);
        });
    });
</script>
</body>
</html>
