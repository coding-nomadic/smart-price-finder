<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Smart Price Finder</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body, html {
            height: 100%;
            margin: 0;
            font-family: 'Roboto', Arial, sans-serif;
            background: #121212;
            color: #ffffff;
        }

        .search-container {
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .form-title {
            font-size: 2.5rem;
            font-weight: 500;
            color: #4da6ff;
            margin-bottom: 30px;
            text-align: center;
        }

        input, select, button {
            border-radius: 24px;
            background: #1f1f1f;
            color: #ffffff;
            border: 1px solid #ccc;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #4da6ff;
            box-shadow: 0 0 8px rgba(77, 166, 255, 0.5);
        }

        button {
            background: #4da6ff;
            color: #fff;
            font-weight: 500;
            transition: 0.3s;
        }

        button:hover {
            background: #3399ff;
        }

        .results-container {
            margin-top: 30px;
        }

        .store-card {
            background: #1e1e1e;
            padding: 18px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.5);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .store-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.6);
        }

        .availability.in-stock { color: #4caf50; font-weight: bold; }
        .availability.low-stock { color: #ff9800; font-weight: bold; }
        .availability.out-of-stock { color: #f44336; font-weight: bold; }

        .error {
            background: #f44336;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
            font-weight: bold;
        }

        #toast {
            display:none;
            margin:10px auto;
            padding:16px 22px;
            background:#ff9800;
            color:#fff;
            border-radius:10px;
            text-align:center;
            max-width:400px;
            font-weight:bold;
            font-size: 0.95rem;
            box-shadow:0 2px 6px rgba(0,0,0,0.5);
            opacity:0;
            transition: opacity 0.5s;
        }
    </style>
</head>
<body>

<div class="search-container container">
    <div class="form-title">Smart Price Finder</div>
    <form action="/generate" method="post" class="w-100" style="max-width:600px;">
        <div class="mb-3">
            <input type="text" name="query" class="form-control form-control-lg" placeholder="Search for a product..." required>
        </div>
        <div class="row g-2">
            <div class="col-md">
                <select id="province" name="province" class="form-select form-select-lg" required>
                    <option value="" disabled selected>Province</option>
                    <option value="AB">Alberta</option>
                    <option value="BC">British Columbia</option>
                    <option value="MB">Manitoba</option>
                    <option value="NB">New Brunswick</option>
                    <option value="NL">Newfoundland and Labrador</option>
                    <option value="NS">Nova Scotia</option>
                    <option value="ON">Ontario</option>
                    <option value="PE">Prince Edward Island</option>
                    <option value="QC">Quebec</option>
                    <option value="SK">Saskatchewan</option>
                    <option value="NT">Northwest Territories</option>
                    <option value="NU">Nunavut</option>
                    <option value="YT">Yukon</option>
                </select>
            </div>
            <div class="col-md">
                <select id="city" name="city" class="form-select form-select-lg" required>
                    <option value="" disabled selected>City</option>
                </select>
            </div>
            <div class="col-md">
                <button type="submit" class="btn btn-lg w-100">Find Prices</button>
            </div>
        </div>
    </form>
</div>

<div class="container results-container" th:if="${stores}">
    <div th:each="store : ${stores}" class="store-card mb-3" th:data-availability="${store.availability}">
        <div class="d-flex flex-column flex-md-row justify-content-between">
            <div class="left-info">
                <h5 th:text="${store.productName}">Product Name</h5>
                <p><strong>Store:</strong> <span th:text="${store.storeName}">Store Name</span> (<span th:text="${store.storeType}">Type</span>)</p>
                <p><strong>Availability:</strong>
                    <span class="availability"
                          th:classappend="${store.availability == 'In Stock'} ? ' in-stock' :
                                          (${store.availability == 'Low Stock'} ? ' low-stock' : ' out-of-stock')"
                          th:text="${store.availability}">
                    </span>
                </p>
                <p><strong>Distance:</strong> <span th:text="${store.distance}">0</span></p>
                <p><strong>Address:</strong> <span th:text="${store.location}">Address</span></p>
                <p><strong>Last Updated:</strong> <span th:text="${store.lastUpdated}">Today</span></p>
                <p><strong>Website:</strong> <a th:href="${store.website}" target="_blank">Visit Store</a></p>
            </div>
            <div class="right-info text-md-end mt-3 mt-md-0">
                <p class="price">üí≤ $<span th:text="${store.price}">0.00</span></p>
                <p class="discount">üéØ <span th:text="${store.discount}">0%</span></p>
                <p class="rating">‚≠ê <span th:text="${store.rating}">0</span>/5</p>
            </div>
        </div>
    </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
    const provinceCities = {
        "AB":["Calgary","Edmonton","Red Deer","Lethbridge","Fort McMurray","Medicine Hat","Grande Prairie"],
        "BC":["Vancouver","Victoria","Kelowna","Surrey","Burnaby","Richmond","Abbotsford","Nanaimo"],
        "MB":["Winnipeg","Brandon","Steinbach","Thompson","Portage la Prairie","Selkirk"],
        "NB":["Moncton","Fredericton","Saint John","Dieppe","Miramichi","Bathurst"],
        "NL":["St. John's","Mount Pearl","Corner Brook","Gander","Grand Falls-Windsor","Clarenville"],
        "NS":["Halifax","Sydney","Dartmouth","Truro","New Glasgow","Glace Bay"],
        "ON":["Toronto","Ottawa","Hamilton","London","Mississauga","Brampton","Kitchener","Windsor","Thunder Bay"],
        "PE":["Charlottetown","Summerside","Stratford","Cornwall","Montague"],
        "QC":["Montreal","Quebec City","Laval","Gatineau","Longueuil","Sherbrooke","Trois-Rivi√®res","L√©vis"],
        "SK":["Saskatoon","Regina","Prince Albert","Moose Jaw","Yorkton","Swift Current"],
        "NT":["Yellowknife","Hay River","Fort Smith","Inuvik"],
        "NU":["Iqaluit","Rankin Inlet","Arviat","Cambridge Bay"],
        "YT":["Whitehorse","Dawson City","Watson Lake"]
    };

    const provinceSelect = document.getElementById('province');
    const citySelect = document.getElementById('city');

    provinceSelect.addEventListener('change', function() {
        const cities = provinceCities[this.value] || [];
        citySelect.innerHTML = '<option value="" disabled selected>City</option>';
        cities.forEach(city => {
            const option = document.createElement('option');
            option.value = city;
            option.textContent = city;
            citySelect.appendChild(option);
        });
    });
</script>
</body>
</html>
